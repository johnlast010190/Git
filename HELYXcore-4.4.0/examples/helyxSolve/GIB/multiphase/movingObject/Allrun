#!/bin/bash
cd "${0%/*}" || exit 1    # Run from this directory
set -e                    # Exit immediately if a command fails

#------------------------------------------------------------------------------

mkdir -p constant/triSurface
cp "$HELYX_TUTORIALS"/resources/geometry/GIBgeometries/GIB_box.stl constant/triSurface/

helyxRun blockMesh
helyxRun topoSet
helyxRun refineMesh -overwrite

helyxRun setSet -batch system/cellSet.batch
helyxRun subsetMesh -overwrite c1 -patch walls
mv log.setSet log.setSet1

helyxRun setSet -batch system/setSet.batch
mv log.setSet log.setSet2

helyxRun createPatch -overwrite
helyxRun modifyGIBBoundary -addGIB
helyxRun caseSetup

helyxRun setSet -batch system/setSet.batch
mv log.setSet log.setSet3

helyxRun setFields
helyxRun helyxSolve

# Create dummy file for ParaView visualization
touch movingObject.foam

#------------------------------------------------------------------------------
